$.widget("coalexe.notifications",{options:{closeMethod:"auto",showDuration:200,hideDuration:500},_create:function(){var b=this,d=[];b._id=1;b._notifications=[];b._bindEvents();b.element.hasClass("notifications")||b.element.addClass("notifications");b.element.find("li").each(function(){var a=$(this),b=a.text(),c=(a.attr("class")?a.attr("class").split(" "):[]).find(function(a){return a.startsWith("notification-")}),c=c?c.substr(c.indexOf("-")+1):"info";d.push({message:b,type:c});a.remove()});d.forEach(function(a){b.add(a.message,
a.type)})},_destroy:function(){this._notifications=null;this.element.find("li").removeAttr("data-notification-id")},_bindEvents:function(){"click"===this.options.closeMethod?this._on({"click li":this._removeNotificationClickHandler}):"button"===this.options.closeMethod&&this._on({"click .close-button":this._removeNotificationCloseButtonHandler})},add:function(b,d){var a=this,e=this._findNotificationByMessageAndType(b,d);if(void 0===e){a._notifications.push({id:a._id,message:b,type:d});var c=$("<li></li>").addClass("notification-"+
d).text(b).attr("data-notification-id",a._id++).hide();"button"===a.options.closeMethod&&(e=$("<span></span>").addClass("close-button"),c.append(e));"click"===a.options.closeMethod&&c.addClass("notification-click").attr("title","Click to close");a.element.append(c);"auto"===a.options.closeMethod?c.slideDown(a.options.showDuration,function(){a._removeNotification(c)}):c.slideDown(a.options.showDuration)}else{var f=a.element.find("li[data-notification-id="+e.id+"]");f.fadeOut(250,function(){f.fadeIn(250)})}},
_removeNotificationClickHandler:function(b){this._removeNotification($(b.target))},_removeNotificationCloseButtonHandler:function(b){this._removeNotification($(b.target).parent())},_removeNotification:function(b){var d=this,a=b.data("notification-id"),e=d._findNotificationIndexById(a),a=function(){b.remove();"number"===typeof e&&d._notifications.splice(e,1)};0===e?b.fadeOut(d.options.hideDuration,a):b.slideUp(d.options.hideDuration,a)},_findNotificationIndexById:function(b){for(var d,a=this._notifications.length,
e=0;e<a;e++)if(this._notifications[e].id===b){d=e;break}return d},_findNotificationByMessageAndType:function(b,d){for(var a,e=this._notifications.length,c=0;c<e;c++)if(this._notifications[c].type===d&&this._notifications[c].message===b){a=this._notifications[c];break}return a}});
